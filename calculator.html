<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Gelato Expert Platform</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
.fade-in{animation:fadeIn 0.3s}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.section-card{transition:transform 0.2s, box-shadow 0.2s}
.section-card:hover{transform:translateY(-4px);box-shadow:0 20px 25px -5px rgba(0,0,0,0.1)}
</style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen">
<div id="root"></div>
<script>
// ========================================
// COMPLETE PROFESSIONAL KNOWLEDGE BASE
// Integrated from professional gelato making science
// ========================================

const KB={
// FUNDAMENTALS
fund:`PROFESSIONAL GELATO FUNDAMENTALS

ARTISAN vs INDUSTRIAL:
‚Ä¢ Overrun: 20-40% vs 80-100%
‚Ä¢ Temperature: -10 to -14¬∞C vs -18 to -25¬∞C  
‚Ä¢ Fat: 6-10% vs 10-16%
‚Ä¢ Texture: Dense, creamy vs Light, fluffy
‚Ä¢ Production: Daily, fresh vs Mass, frozen stock

KEY PARAMETERS:
‚Ä¢ PAC (Anti-Freezing Power): 180-375 range
  - Controls hardness and scoopability
  - Based on molecular weight
  - Lower MW = Higher PAC = Softer gelato

‚Ä¢ POD (Sweetening Power): Relative sweetness
  - Sucrose = 100 reference
  - Influences palatability

‚Ä¢ Total Solids: 32-42% in cream gelato
‚Ä¢ Overrun: Air incorporation 20-35%

GELATO TYPES:
‚Ä¢ CREAM (Crema): Made with milk/cream base
‚Ä¢ SORBET (Sorbetto): No milk, fruit + water + sugar

Classification by METHOD not main ingredient
Example: Hazelnut is "cream" gelato (uses milk base)`,

// PRODUCTION CYCLE
prod:`COMPLETE PRODUCTION CYCLE

7 ESSENTIAL STEPS:

1. RECIPE FORMULATION
   - Calculate PAC, POD, solids
   - Balance all parameters
   - Precision weighing

2. PASTEURIZATION
   - HIGH: 85¬∞C for 1 minute
   - LOW: 65¬∞C for 30 minutes
   - Complete sanitization
   - Ingredient integration

3. MATURATION (CRITICAL!)
   - 4-12 hours at 4¬∞C
   - Stabilizer hydration
   - Fat crystallization
   - Flavor development
   - NEVER SKIP THIS STEP

4. BATCH FREEZING (Mantecazione)
   - Simultaneous cooling & mixing
   - -2.5¬∞C: Freezing starts
   - -4 to -5¬∞C: Air incorporation
   - -7 to -10¬∞C: Extraction
   - ~65% water frozen at -7¬∞C

5. BLAST CHILLING
   - Rapid freeze to -18¬∞C
   - Air speed: 6 m/s
   - Prevents large ice crystals
   - 30-90 minutes

6. STORAGE
   - Pozzetti: -18 to -20¬∞C
   - Display: -14 to -16¬∞C
   - Maintain constant temp

7. SELLING
   - Proper presentation
   - Temperature management
   - Service technique`,

// SORBET MASTERY
sorb:`SORBET COMPLETE GUIDE

GOLDEN RULE: 26-32% TOTAL SUGAR

Why this range?
‚Ä¢ Below 26%: Too hard, icy
‚Ä¢ 26-32%: Perfect scoopability  
‚Ä¢ Above 32%: Too soft, melts fast

FRUIT CLASSIFICATION:

üî• STRONG (10-20% usage):
Lemon, Lime, Mango, Passionfruit, Grapefruit
Very intense - small amount needed

üåü MEDIUM (20-50% usage):
Strawberry, Kiwi, Apricot, Pineapple, Banana,
Cherry, Melon, Blueberry, Peach, Raspberry
Balanced intensity

üíß WEAK (>50% usage):
Watermelon, Orange, Apple, Pear, Grape
Subtle - large amount needed

ESSENTIAL INGREDIENTS:

STABILIZER (Neutro): 0.5% (5g per kg)
‚Ä¢ Controls ice crystals
‚Ä¢ Improves texture
‚Ä¢ Extends shelf life
‚Ä¢ NEEDS 4-12h maturation!

GLUCOSE SYRUP 42DE: 3-5%
‚Ä¢ 80% solids, 20% water
‚Ä¢ Less sweet than sucrose
‚Ä¢ Smooth texture
‚Ä¢ Prevents crystallization

DEXTROSE: 2-5%
‚Ä¢ PAC 1.9 (high anti-freezing)
‚Ä¢ POD 0.7 (less sweet)
‚Ä¢ Keeps soft when cold

INULIN (Fiber): 1-10%
‚Ä¢ For liquid sorbets (lemon)
‚Ä¢ Creates body structure
‚Ä¢ Prebiotic benefit

CALCULATE FRUIT SUGAR:
All fruits ‚âà 10% natural sugar
Example: 400g strawberry = 40g sugar
Must account in total!

FRUIT OPTIONS:
‚Ä¢ Fresh: Best marketing, seasonal
‚Ä¢ IQF Frozen: Year-round, consistent
‚Ä¢ Puree: Professional, reliable
‚Ä¢ Juice: Clean flavor, needs fiber
‚Ä¢ Paste: Flavor boost, 40-60g/kg

TARGET PAC: 275-375 for sorbet`,

// CREAM GELATO
cream:`CREAM GELATO MASTERY

TARGET RANGES:
‚Ä¢ Fat: 6-10%
‚Ä¢ MSNF (Milk Solids): 9-12%
‚Ä¢ Sugars: 16-22%
‚Ä¢ Total Solids: 36-42%
‚Ä¢ PAC: 200-280
‚Ä¢ POD: 16-22%
‚Ä¢ Protein: 4-5%
‚Ä¢ Stabilizers: 0.3-0.6%
‚Ä¢ Emulsifiers: 0.2-0.4%

ESSENTIAL INGREDIENTS:

MILK (Whole 3.5% fat):
‚Ä¢ 3.3% protein
‚Ä¢ 4.8% lactose
‚Ä¢ Base structure

CREAM (30-35% fat):
‚Ä¢ Richness & creaminess
‚Ä¢ 8-15% of mix typical

MILK POWDER (Skim):
‚Ä¢ 36% protein
‚Ä¢ Increases MSNF
‚Ä¢ 2-4% dosage max

EGG YOLK:
‚Ä¢ 32% fat, 16% protein
‚Ä¢ Natural emulsifier (lecithin)
‚Ä¢ Rich flavor
‚Ä¢ 3-6% dosage
‚Ä¢ MUST pasteurize!

STABILIZERS: 0.3-0.6%
Lower than sorbet due to milk proteins

EMULSIFIERS: 0.2-0.4%
‚Ä¢ Coat fat globules
‚Ä¢ Improve overrun
‚Ä¢ Smoother texture
‚Ä¢ Egg yolk is natural option

BASE RECIPE - Fior di Latte:
Whole Milk: 700g
Cream 35%: 100g
Sucrose: 150g
Dextrose: 30g
Milk Powder: 20g
Stabilizer: 5g
Emulsifier: 3g
Total: 1008g

Analysis: ~7% fat, ~240 PAC, ~38% solids`,

// ADVANCED SUGARS
sug_adv:`ADVANCED SUGAR SCIENCE

PAC CALCULATION SYSTEM:
Based on Molecular Weight (MW)
PAC = 342 √∑ MW of sugar
(Sucrose MW = 342, PAC = 1.0 reference)

COMPLETE SUGAR DATABASE:

SUCROSE: PAC 1.0, POD 1.0, MW 342
Base sugar, 10-15% cream, 15-25% sorbet

DEXTROSE: PAC 1.9, POD 0.7, MW 180
High anti-freezing, less sweet, 2-8% usage

FRUCTOSE: PAC 1.9, POD 1.3, MW 180
Very sweet, use sparingly 2-5% max

GLUCOSE 42DE: PAC 0.37, POD 0.8, MW ~928
3-5% usage, smooth texture

INVERTED SUGAR: PAC 1.6, POD 1.2
50% dextrose + 50% fructose
Prevents crystallization

LACTOSE: PAC 1.0, POD 0.16, MW 342
Milk sugar, barely sweet
Can crystallize (sandy texture)

TREHALOSE: PAC 1.0, POD 0.45
Perfect for savory/gastronomic gelato
Same PAC, half sweetness

MALTODEXTRIN: PAC 0.3, POD 0.3
HARDENS gelato, creates structure
Use in low-fiber sorbets 2-5%

HONEY: PAC 1.4, POD 1.2
Natural inverted sugar
Variable composition

THREE PAC TYPES:

RELATIVE PAC:
Sum of (Sugar% √ó PAC)
Basic calculations
Target: 220-280 cream, 275-375 sorbet

TOTAL PAC:
Includes mineral salts from milk
PAC ~5, MW 68
Cream base: ~290-300 total

ABSOLUTE PAC:
Total PAC √∑ kg water in mix
True concentration in aqueous phase
More accurate theoretically

PRACTICAL USE:
Relative PAC √∑ -20 = Showcase temp estimate
Example: 240 PAC √∑ -20 = -12¬∞C display`,

// POLYALCOHOLS
poly:`POLYALCOHOLS & ALTERNATIVE SWEETENERS

IDENTIFICATION:
Ends in "-OL" = Alcohol (erythritol, sorbitol)
Ends in "-OSE" = Sugar (sucrose, lactose)

KEY PROPERTIES:
‚úÖ Lower calories: 2.4 vs 4 kcal/g
‚úÖ Lower glycemic index
‚úÖ Provide PAC (anti-freezing)
‚ùå Laxative effect (poor absorption)
‚ùå Individual tolerance varies

ERYTHRITOL: PAC 2.8, POD 0.7
‚Ä¢ Best tolerance, minimal laxative
‚Ä¢ 0.2 kcal/g (lowest)
‚Ä¢ Perfect for low-cal, low-GI

SORBITOL: PAC 1.9, POD 0.6
‚Ä¢ Max dose: 13-14g per serving
‚Ä¢ Moderate laxative effect

XYLITOL: PAC 1.9, POD 1.0
‚Ä¢ Almost as sweet as sucrose
‚Ä¢ Dental benefits
‚Ä¢ Expensive

MALTITOL: PAC 0.9, POD 0.9
‚Ä¢ Close to sucrose
‚Ä¢ Direct replacement

ISOMALT: PAC 1.0, POD 0.5
‚Ä¢ Half as sweet
‚Ä¢ Sugar substitute

CRITICAL FOR BALANCING:
Traditional sugar % rules DON'T APPLY!

USE PAC-BASED:
Target 240-260 Total PAC (cream)
Calculate until reaching target PAC

FIBER PARADOX:
Theory: More fiber ‚Üí Less water ‚Üí Softer
Reality: More fiber ‚Üí HARDER
Why? Physical structure, not just freezing point

HIGH-INTENSITY SWEETENERS:
SUCRALOSE: 600√ó sweeter, PAC 0
STEVIA: Natural, very sweet, PAC 0
ASPARTAME: 200√ó sweeter, not heat stable

ALL provide sweetness, NO structure!
Must combine with:
‚Ä¢ Polyalcohols (PAC)
‚Ä¢ Maltodextrin (body)
‚Ä¢ Fiber (structure)`,

// ALCOHOL
alc:`ALCOHOL IN GELATO

ETHANOL PROPERTIES:
Theoretical PAC: 7.4 (MW 46)
Reality: Lower in practice

EFFECTIVE PAC:
Cream bases: 2.5-3.0
(Binds to proteins, fats)

Sorbets: ~5.0
(Simple matrix, higher effect)

DOSAGE GUIDELINES:

LIGHT (0.5-1%):
15g pure alcohol per kg
Subtle, family-friendly

MEDIUM (1-2%):
20g pure alcohol per kg
Noticeable, adult product

STRONG (2-3%):
30g pure alcohol per kg
Very soft, label required

CALCULATION:
(Beverage ml √ó % Alcohol) √∑ 100 = Pure ml

Example - 40% Liquor:
60ml √ó 40% = 24ml pure (24g)
In 1kg = 2.4% alcohol

TYPICAL RECIPES:

AMARETTO: 70ml (28%) = 19.6g (~2%)
LIMONCELLO: 100ml (30%) = 30g (3%)
RUM: 50ml (40%) = 20g (2%)
WINE: 150ml (13%) = 19.5g (~2%)

BALANCING:
‚Ä¢ Subtract alcohol PAC from sugar needs
‚Ä¢ Account for beverage water content
‚Ä¢ Reduce other sugars

CHALLENGES:
Too much: Won't freeze
Too little: Weak flavor
Perfect: 1.5-2.5% pure alcohol`,

// FIBER SCIENCE
fib:`FIBER COMPLETE SCIENCE

DEFINITION:
Plant parts resistant to digestion
Prebiotic benefit

TYPES:

INSOLUBLE:
‚Ä¢ Cellulose, cocoa fiber
‚Ä¢ Absorbs water, doesn't dissolve
‚Ä¢ Visible structure
‚Ä¢ Creates body

SOLUBLE:
‚Ä¢ Inulin, pectin, FOS
‚Ä¢ Dissolves completely
‚Ä¢ Invisible
‚Ä¢ Increases viscosity

THE PARADOX:

THEORY: More fiber ‚Üí Less water ‚Üí Softer
REALITY: More fiber ‚Üí HARDER

Why?
‚Ä¢ Creates physical structure
‚Ä¢ PAC only measures freezing
‚Ä¢ Doesn't account for hardness
‚Ä¢ Both effects occur

INULIN (Most Common):
‚Ä¢ From chicory root
‚Ä¢ Fructose polymer
‚Ä¢ Completely soluble
‚Ä¢ Neutral taste

Dosage:
‚Ä¢ Lemon sorbet: 5-10%
‚Ä¢ Fruit sorbet: 1-3%
‚Ä¢ Cream gelato: 0-2%

Functions:
‚úÖ Body to liquid sorbets
‚úÖ Mimics fat mouthfeel
‚úÖ Prebiotic benefit
‚úÖ Clean label

PECTIN:
‚Ä¢ From citrus, apple
‚Ä¢ HM or LM types
‚Ä¢ Fruit sorbets: 0.3-0.5%

Functions:
‚úÖ Gel formation
‚úÖ Prevents separation
‚úÖ Natural ingredient

POLYDEXTROSE:
‚Ä¢ Synthetic fiber
‚Ä¢ PAC 0.1, POD 0.1
‚Ä¢ 1 kcal/g
‚Ä¢ 2-5% usage

BALANCING RULE:
For every 10g fiber ‚Üí Add 10g dextrose
Compensates hardening effect

PREBIOTIC vs PROBIOTIC:
Prebiotic: Feeds bacteria (inulin, FOS)
Probiotic: Is bacteria (Lactobacillus)

LIMITATIONS:
‚Ä¢ Laxative at high doses
‚Ä¢ ~2 kcal/g (not zero)
‚Ä¢ Can affect flavor
‚Ä¢ Test and adjust`,

// PROTEINS
prot:`PROTEINS IN GELATO

WHAT ARE PROTEINS:
Amino acid chains
"Noble": All essential amino acids
Sources: Dairy, eggs, meat, legumes

DENATURATION:
Process where protein unfolds
Causes: Heat (>50-60¬∞C), acid, mechanical

Effects:
‚ùå Loss of original function
‚úÖ Nutritional value unchanged
‚úÖ NEW functional properties
‚úÖ Better for gelato

MILK PROTEINS:

CASEIN (80%):
‚Ä¢ Most heat-stable (>100¬∞C)
‚Ä¢ Forms micelles
‚Ä¢ Primary emulsifier
‚Ä¢ Stabilizes fat globules

WHEY (20%):
‚Ä¢ Denatures at 60-70¬∞C
‚Ä¢ Œ≤-lactoglobulin, Œ±-lactalbumin
‚Ä¢ Foam formation
‚Ä¢ Water binding

DURING PASTEURIZATION (85¬∞C):
‚Ä¢ Whey proteins denature ‚Üí Better foam
‚Ä¢ Casein stays stable ‚Üí Continues emulsifying
‚Ä¢ New interactions form ‚Üí Improved texture

TARGET: 4-5% protein in cream

SOURCES:
Whole Milk: 3.3% protein
Skim Milk Powder: 36% protein
Cream 35%: 2.2% protein
Egg Yolk: 16% protein

FUNCTIONS:

‚úÖ EMULSIFICATION:
Coat fat globules, prevent coalescence

‚úÖ FOAM FORMATION:
Stabilize air bubbles, improve overrun

‚úÖ WATER BINDING:
Hold water, reduce free water

‚úÖ MOUTHFEEL:
Creaminess, body, texture

‚úÖ FLAVOR CARRIER:
Bind and release flavors

EGG YOLK SPECIAL:
‚Ä¢ 48% water, 32% fat, 16% protein
‚Ä¢ Natural lecithin (emulsifier)
‚Ä¢ Richness + Color
‚Ä¢ Dosage: 2-6% of mix
‚Ä¢ MUST pasteurize (Salmonella risk)

PROBLEMS:

TOO LOW (<3%):
Weak emulsion, poor air, thin

TOO HIGH (>6%):
Gummy texture, chewy, sandy

OPTIMAL (4-5%):
Perfect balance, professional quality

VEGAN PROTEINS:
‚Ä¢ Pea (flavor issues)
‚Ä¢ Potato (best - neutral)
‚Ä¢ Soy (acceptable)
Replace 1:1 with milk protein`,

// FATS
fats:`FATS & OILS SCIENCE

TERMINOLOGY:
FAT = Solid at room temp
OIL = Liquid at room temp
Both are LIPIDS

COMPOSITION:
96-97% Triglycerides
3-4% Other (vitamins, pigments)

TRIGLYCERIDE STRUCTURE:
Glycerol backbone + 3 fatty acid chains

SATURATED: No double bonds
‚Ä¢ Straight chains
‚Ä¢ Pack tightly ‚Üí SOLID
‚Ä¢ High melting point

UNSATURATED: Double bonds
‚Ä¢ Bent chains
‚Ä¢ Can't pack ‚Üí LIQUID
‚Ä¢ Low melting point

MELTING BEHAVIOR:
NOT sharp point - RANGE
Butter: 15-35¬∞C range
Coconut: 24-28¬∞C range

MILK FAT:
‚Ä¢ 70% saturated
‚Ä¢ 30% unsaturated
‚Ä¢ Complex (400+ triglycerides)
‚Ä¢ Melting: 15-35¬∞C
‚Ä¢ Perfect for gelato

CREAM:
Light: 18-30% fat
Heavy: 33-36% fat
Double: 45-48% fat
Typical use: 30-35% cream

COCONUT OIL (Vegan):
‚Ä¢ 90% saturated
‚Ä¢ Melting: 24-28¬∞C
‚Ä¢ Perfect substitute
‚Ä¢ Refined = neutral flavor
‚Ä¢ 6-10% dosage

COCOA BUTTER:
‚Ä¢ From cocoa bean
‚Ä¢ Melting: 32-35¬∞C
‚Ä¢ Sharp melting
‚Ä¢ Chocolate character

FAT CRYSTALLIZATION:
During maturation (4¬∞C):
‚Ä¢ Partial crystallization
‚Ä¢ Network structure forms
‚Ä¢ Essential for air incorporation

Without:
‚ùå Poor overrun
‚ùå Separation
‚ùå Oily texture

TARGETS:
Minimum: 5% (barely creamy)
Optimal: 7-9% (balanced)
Rich: 10-12% (very rich)
Maximum: 12% (problems above)

TOO LITTLE (<5%):
Icy, not creamy, fast melting

TOO MUCH (>12%):
Hard to churn, low air, coating

PERFECT (7-9%):
Professional quality, balanced

CALCULATION EXAMPLE:
Milk 650g (3.5%) = 22.75g
Cream 100g (35%) = 35g
Egg 40g (32%) = 12.8g
Total: 70.55g = 7.05% ‚úì

HOMOGENIZATION:
‚Ä¢ 100-200 bar pressure
‚Ä¢ Breaks globules to <2 Œºm
‚Ä¢ Stable emulsion
‚Ä¢ Not always necessary for artisan`,

// PASTEURIZATION
past:`PASTEURIZATION - CRITICAL STEP

PURPOSE:
‚Ä¢ Kill pathogenic bacteria
‚Ä¢ Reduce bacterial load
‚Ä¢ Legal requirement
‚Ä¢ Complete integration
‚Ä¢ >72h shelf life at 4¬∞C

BACTERIAL DANGER ZONE: 10-40¬∞C

Temperature guide:
Below 10¬∞C: Dormant
10-40¬∞C: DANGER - rapid growth
~40¬∞C: Maximum reproduction
Above 60¬∞C: Start dying
85¬∞C: Complete sanitization

TWO METHODS:

HIGH PASTEURIZATION:
‚Ä¢ 85¬∞C for 1 minute
‚Ä¢ Fast process
‚Ä¢ Standard professional
‚Ä¢ Most common

LOW PASTEURIZATION:
‚Ä¢ 65¬∞C for 30 minutes
‚Ä¢ Gentler
‚Ä¢ Small batches
‚Ä¢ Delicate ingredients

CRITICAL RULES:

1. MIX POWDERS WITH SUGAR FIRST
All powders + sugar ‚Üí Mix ‚Üí Then add
Prevents lumping

2. ADD POWDERS AT 30-40¬∞C
Slowly, like "rain"
Below 30¬∞C: Won't dissolve
Above 60¬∞C: Lumps form

3. NEVER DISTRACT
One mistake = ruined batch
Stay focused entire process

4. CREAM DURING HEATING
Add cream BEFORE 85¬∞C
Never cold cream at 50¬∞C = DANGEROUS!

Exception: Cold cream at 4¬∞C OK
Must be fresh, <4¬∞C, use immediately

WHAT HAPPENS:
‚Ä¢ Sugars dissolve completely
‚Ä¢ Milk powder disperses
‚Ä¢ Stabilizers absorb water
‚Ä¢ Emulsifiers activate
‚Ä¢ Proteins denature (whey)
‚Ä¢ Fats distribute
‚Ä¢ Complete homogenization

PROCESS:
1. Prepare powder/sugar mix
2. Pour milk (+ cream)
3. Start heating
4. At 30-40¬∞C: Add powders slowly
5. Stir constantly
6. Heat to 85¬∞C
7. Hold 1 minute
8. Cool rapidly to 4¬∞C
9. Transfer to maturation

Time: ~30-35 minutes total`,

// MATURATION
matur:`MATURATION - THE MOST IMPORTANT STEP

NEVER SKIP THIS!

PARAMETERS:
‚Ä¢ Temperature: 4¬∞C exactly
‚Ä¢ Minimum: 4 hours
‚Ä¢ Recommended: 8-12 hours
‚Ä¢ Optimal: 24 hours
‚Ä¢ Maximum: 48 hours

WHY ESSENTIAL:

1. STABILIZER HYDRATION:
‚Ä¢ Takes 4-12 hours
‚Ä¢ Becomes functional
‚Ä¢ Creates viscosity
‚Ä¢ Controls crystals
Primary benefit!

2. FAT CRYSTALLIZATION:
‚Ä¢ Solidifies at 4¬∞C
‚Ä¢ Forms network
‚Ä¢ Essential for air
‚Ä¢ Stabilizes bubbles

3. PROTEIN HYDRATION:
‚Ä¢ Full water absorption
‚Ä¢ Better interactions
‚Ä¢ Improved stability

4. FLAVOR DEVELOPMENT:
‚Ä¢ Ingredients meld
‚Ä¢ Complex profile
‚Ä¢ Better taste

5. HOMOGENIZATION:
‚Ä¢ Complete uniformity
‚Ä¢ No separation

WITHOUT MATURATION:

‚ùå Icy, grainy texture
‚ùå Large ice crystals
‚ùå Poor air incorporation
‚ùå Low overrun
‚ùå Unstable structure
‚ùå Fast melting
‚ùå Weak flavor
‚ùå Short shelf life

WITH PROPER:

‚úÖ Smooth, creamy
‚úÖ Small crystals
‚úÖ Excellent air
‚úÖ Stable structure
‚úÖ Slow melting
‚úÖ Rich flavor
‚úÖ Extended life

HOW TO MATURE:
1. After pasteurization + cooling to 4¬∞C
2. Pour into clean containers
3. Cover tightly
4. Label (recipe, date, time)
5. Refrigerate at 4¬∞C
6. Don't disturb
7. Wait minimum time
8. Proceed to batch freezing

PRODUCTION SCHEDULE:

NEXT-DAY (Ideal):
Day 1, 5 PM: Pasteurize
Day 2, 9 AM: Batch freeze
= 16 hours maturation

SAME-DAY (Minimum):
9 AM: Pasteurize
2 PM: Batch freeze
= 5 hours (acceptable if necessary)

PROFESSIONAL:
Day 1 AM: Pasteurize
Day 2 AM: Batch freeze
= 24 hours (best quality)`,

// BATCH FREEZING
batch:`BATCH FREEZING (MANTECAZIONE)

DEFINITION:
Simultaneous cooling + mixing
Transforms liquid ‚Üí gelato

TWO CRITICAL ELEMENTS:
1. Water freezing into ice
2. Air incorporation (overrun)

TEMPERATURE JOURNEY:

START: 4¬∞C from maturation

-2.5¬∞C: Freezing begins
First ice crystals form

-4 to -5¬∞C: Air incorporation zone
Most air absorbed here
Mix becomes foamy

-7 to -10¬∞C: Extraction point
Process stops
~65% water is ice (at -7¬∞C)
35% remains liquid (captured by sugars)

PROGRESSIVE CONCENTRATION:
As water freezes ‚Üí Remaining water concentrates sugars
‚Üí Freezing point lowers ‚Üí Not all water freezes

OVERRUN - AIR FACTOR:

Definition: Volume increase from air

Formula:
Overrun % = ((Final - Initial) / Initial) √ó 100

Standards:
‚Ä¢ Sorbet: 15-20%
‚Ä¢ Cream: 30-40%
‚Ä¢ Industrial: 80-100%

Why air matters:
‚úÖ Makes scoopable (not hard ice)
‚úÖ Creamy texture
‚úÖ Better mouthfeel
‚úÖ Lightness
‚úÖ Insulates (slows melting)

FACTORS AFFECTING OVERRUN:

SUGARS (High = Longer time = Lower overrun)
MSNF (Stabilizes bubbles = Higher overrun)
FATS (Moderate good, >12% = Lower overrun)
STABILIZERS (Trap air = Better overrun)

EXTRACTION TEMPERATURE:

-7¬∞C: Balance texture + stability
-8 to -9¬∞C: Firmer (for pozzetti)
-10¬∞C: Very firm (direct to display)

MACHINE DYNAMICS:
‚Ä¢ Motor (paddle speed)
‚Ä¢ Compressor (cooling)
‚Ä¢ Electronic control (manages both)

Fast paddles = Small crystals = Smooth
Slow paddles = Large crystals = Grainy

SENSORS DETECT:
‚Ä¢ Temperature drop
‚Ä¢ Consistency increase
‚Ä¢ Signals ready

TIME:
Typically 8-15 minutes depending on:
‚Ä¢ Batch size
‚Ä¢ Machine power
‚Ä¢ Formula
‚Ä¢ Target temperature`,

// BLAST CHILLING
blast:`BLAST CHILLING & STORAGE

WHY BLAST CHILL:
Rapidly freeze from -8¬∞C to -18¬∞C
Prevents large crystal formation
Stabilizes structure quickly

BLAST CHILLER:
‚Ä¢ Air speed: 6 m/s (fast!)
‚Ä¢ Temperature: -35 to -40¬∞C
‚Ä¢ Time: 30-90 minutes
‚Ä¢ Result: Excellent texture

vs REGULAR FREEZER:
‚Ä¢ Minimal air movement
‚Ä¢ -18¬∞C only
‚Ä¢ 4-6 hours
‚Ä¢ Acceptable but not optimal

AFTER BLAST CHILLING:

STORAGE OPTIONS:

POZZETTI (Wells):
‚Ä¢ Temperature: -18 to -20¬∞C
‚Ä¢ Static or ventilated
‚Ä¢ Best preservation
‚Ä¢ Less stress on product
‚Ä¢ Stable temperature
‚Ä¢ Minimal maintenance

ADVANTAGES:
‚úÖ Excellent temperature constancy
‚úÖ Less stress on gelato
‚úÖ Better preservation
‚úÖ Easy management
‚úÖ Long shelf life

DISADVANTAGES:
‚ùå No visual merchandising
‚ùå Customer doesn't see product

DISPLAY CASE (Vetrina):
‚Ä¢ Temperature: -14 to -16¬∞C
‚Ä¢ Air flow: 1-2 m/s over surface
‚Ä¢ Visual merchandising
‚Ä¢ Impulse buying

ADVANTAGES:
‚úÖ Customers see gelato
‚úÖ Attractive presentation
‚úÖ Drives sales

DISADVANTAGES:
‚ùå More maintenance
‚ùå Must sculpt daily
‚ùå Temperature fluctuations
‚ùå More stress on product

CHOOSING SYSTEM:
Ask: "Which sells MORE gelato in MY location?"

High foot traffic = Display
Regular customers = Pozzetti
Quality priority = Pozzetti
Visual appeal critical = Display

STORAGE QUALITY:
‚Ä¢ Maintain constant temperature
‚Ä¢ Avoid fluctuations
‚Ä¢ Cover products
‚Ä¢ Label everything
‚Ä¢ FIFO rotation
‚Ä¢ Maximum quality: 3-5 days

RECRYSTALLIZATION:
During storage, ice crystals grow
‚Üí Gritty texture over time
‚Üí This is why fresh is best
‚Üí Can't completely prevent
‚Üí Stabilizers slow it down`,

// EQUIPMENT
equip:`PROFESSIONAL EQUIPMENT GUIDE

THREE CORE MACHINES:

1. PASTEURIZER (20-100L):
Heating systems:
‚Ä¢ Water bath (most common)
‚Ä¢ Plate heating
‚Ä¢ "Dry water bath"

Functions:
‚Ä¢ Sanitization (85¬∞C)
‚Ä¢ Ingredient integration
‚Ä¢ Homogenization

Key: Proper agitation essential

2. BATCH FREEZER (5-30L):

Types:
‚Ä¢ Vertical (historical)
‚Ä¢ Horizontal (modern, professional)

Components:
‚Ä¢ Motor (paddle rotation)
‚Ä¢ Compressor (cooling)
‚Ä¢ Electronic control
‚Ä¢ Sensors

Balance: Motor + compressor + control

3. BLAST CHILLER:

Types:
‚Ä¢ Countertop (10-15 kg)
‚Ä¢ Roll-in (60-100 kg)
‚Ä¢ Tunnel (continuous)

Functions:
‚Ä¢ Rapid freeze
‚Ä¢ Temperature: -35 to -40¬∞C
‚Ä¢ Air speed: 6 m/s

SUPPORTING EQUIPMENT:

‚Ä¢ Refrigerator (4¬∞C for maturation)
‚Ä¢ Pozzetti or display case
‚Ä¢ Work tables
‚Ä¢ Scales (¬±1g precision)
‚Ä¢ Immersion blender
‚Ä¢ Thermometer (¬±1¬∞C)
‚Ä¢ Refractometer (Brix)
‚Ä¢ Storage containers

LABORATORY DESIGN:

GOLDEN TRIANGLE:
Center these within reach:
1. Pasteurizer
2. Batch freezer
3. Blast chiller

Why?
‚Ä¢ Minimizes movement
‚Ä¢ Efficient workflow
‚Ä¢ Reduces time
‚Ä¢ Less physical strain

OTHER ESSENTIALS:
‚Ä¢ Washing station
‚Ä¢ Ingredient storage
‚Ä¢ Work prep area
‚Ä¢ Finished product storage

VISIBILITY:
Transparent lab = Marketing advantage
Show customers:
‚Ä¢ Cleanliness
‚Ä¢ Process
‚Ä¢ Artisan craft
‚Ä¢ Fresh production

BY BUSINESS LEVEL:

AMATEUR (<50 kg/week):
‚Ä¢ Small batch freezer 1.5-3L
‚Ä¢ Domestic freezer
‚Ä¢ Basic tools
‚Ä¢ $2-5k investment

INTERMEDIATE (50-400 kg/week):
‚Ä¢ Professional batch 5-10L
‚Ä¢ Pasteurizer 20-30L
‚Ä¢ Blast chiller countertop
‚Ä¢ Pozzetti or small display
‚Ä¢ $15-40k investment

PROFESSIONAL (>400 kg/week):
‚Ä¢ Multiple batch 20-30L
‚Ä¢ Pasteurizer 60-100L
‚Ä¢ Blast chiller roll-in
‚Ä¢ Multiple pozzetti
‚Ä¢ Walk-in freezer
‚Ä¢ $80-150k+ investment`,

// TROUBLESHOOTING
trouble:`PROBLEM SOLVING GUIDE

‚ùÑÔ∏è TOO HARD:
Causes:
‚Ä¢ PAC too low (<180)
‚Ä¢ Storage too cold
‚Ä¢ Not enough simple sugars

Solutions:
‚úÖ Add dextrose 2-3%
‚úÖ Add glucose syrup 3-5%
‚úÖ Check display temp (-14 to -16¬∞C)
‚úÖ Add invert sugar 2-3%
‚úÖ Increase PAC target

üíß TOO SOFT:
Causes:
‚Ä¢ PAC too high (>300)
‚Ä¢ Too much dextrose/fructose
‚Ä¢ Low total solids
‚Ä¢ Too much alcohol

Solutions:
‚úÖ Reduce dextrose
‚úÖ Increase sucrose
‚úÖ Add milk powder 2-3%
‚úÖ Increase stabilizers
‚úÖ Check formula balance

üßä ICY/CRYSTALLIZATION:
Causes:
‚Ä¢ Inadequate stabilizers
‚Ä¢ Poor/no maturation
‚Ä¢ Slow freezing
‚Ä¢ Temperature fluctuations
‚Ä¢ Old product

Solutions:
‚úÖ Increase stabilizers to 0.5-0.6%
‚úÖ ENSURE 8-12h maturation minimum
‚úÖ Check batch freezer speed
‚úÖ Maintain stable storage temp
‚úÖ Use fresher
‚úÖ Verify PAC in range

üèñÔ∏è SANDY/GRAINY:
Causes:
‚Ä¢ Excess sucrose crystallization
‚Ä¢ Low stabilizers
‚Ä¢ Inadequate pectin (fruit)
‚Ä¢ Too much lactose
‚Ä¢ High milk powder

Solutions:
‚úÖ Replace sucrose with glucose syrup
‚úÖ Add pectin 0.3-0.5%
‚úÖ Increase stabilizers
‚úÖ Reduce milk powder (<4%)
‚úÖ Check process

üçÆ GUMMY/ELASTIC:
Causes:
‚Ä¢ Too much stabilizer (>0.8%)
‚Ä¢ Excess protein (>6%)
‚Ä¢ Wrong stabilizer type

Solutions:
‚úÖ Reduce stabilizers to 0.3-0.4%
‚úÖ Balance protein to 4-5%
‚úÖ Check stabilizer blend
‚úÖ Review formula

üí® MELTS TOO FAST:
Causes:
‚Ä¢ Very high overrun
‚Ä¢ Low fat content
‚Ä¢ High PAC
‚Ä¢ Serving temp too warm

Solutions:
‚úÖ Reduce air incorporation
‚úÖ Increase fat to 7-9%
‚úÖ Review sugar balance
‚úÖ Serve at correct temp
‚úÖ Check display temperature

üßà BUTTERY/OILY:
Causes:
‚Ä¢ Too much fat (>12%)
‚Ä¢ Fat separation
‚Ä¢ Poor emulsification

Solutions:
‚úÖ Reduce fat to 7-9%
‚úÖ Ensure proper pasteurization
‚úÖ Check emulsifier dosage
‚úÖ Verify maturation

ü•∂ WON'T FREEZE:
Causes:
‚Ä¢ Too much alcohol
‚Ä¢ PAC extremely high
‚Ä¢ Machine malfunction

Solutions:
‚úÖ Reduce alcohol to <3%
‚úÖ Lower total PAC
‚úÖ Check batch freezer function
‚úÖ Recalculate formula

‚ö™ SEPARATED/WATERY:
Causes:
‚Ä¢ No stabilizers
‚Ä¢ Poor pasteurization
‚Ä¢ Incomplete maturation
‚Ä¢ Wrong storage

Solutions:
‚úÖ Add stabilizers
‚úÖ Proper pasteurization
‚úÖ Full maturation time
‚úÖ Maintain temperature

GENERAL TROUBLESHOOTING:
1. Check formula balance
2. Verify all process steps
3. Review temperatures
4. Test equipment
5. Adjust and document
6. Repeat if needed`,

// SPECIAL GELATOS
special:`SPECIAL GELATOS

VEGAN GELATO:

Eliminate:
‚Ä¢ All dairy (milk, cream, butter)
‚Ä¢ Eggs
‚Ä¢ Any animal products

Replace with:
‚úÖ COCONUT OIL (6-10%)
   - Melting: 24-28¬∞C (perfect!)
   - Refined = neutral flavor
   - Best fat substitute

‚úÖ POTATO PROTEIN
   - Most neutral flavor
   - Replaces milk protein
   - 1:1 substitution

Alternatives:
‚Ä¢ Pea protein (vegetal taste)
‚Ä¢ Soy protein (acceptable)
‚Ä¢ Rice protein (weak)

Plant milks:
‚Ä¢ Oat (creamy, neutral)
‚Ä¢ Almond (light, nutty)
‚Ä¢ Soy (protein-rich)
‚Ä¢ Coconut (rich, flavor)

Challenges:
‚Ä¢ Achieving creaminess
‚Ä¢ Texture balance
‚Ä¢ Flavor development

GASTRONOMIC/SAVORY:

Goal: Meal pairing, courses

KEY INGREDIENT: TREHALOSE
‚Ä¢ PAC 1.0 (same as sucrose)
‚Ä¢ POD 0.45 (half sweetness)
‚Ä¢ Allows savory flavors to shine

Applications:
‚Ä¢ Appetizer courses
‚Ä¢ Palate cleansers
‚Ä¢ Cheese pairings
‚Ä¢ Savory flavors (tomato, basil, olive)

Balance:
Less sweetness ‚Üí More flavor perception

ALCOHOLIC GELATO:

Key points:
‚Ä¢ 1.5-2.5% pure alcohol ideal
‚Ä¢ Label clearly
‚Ä¢ Adult product
‚Ä¢ Serves warmer (-12¬∞C)
‚Ä¢ High PAC effect

Common types:
‚Ä¢ Amaretto
‚Ä¢ Limoncello
‚Ä¢ Rum raisin
‚Ä¢ Wine-based
‚Ä¢ Liqueur infusions

LOW GLYCEMIC INDEX:

Use polyalcohols:
‚Ä¢ Erythritol (best)
‚Ä¢ Sorbitol
‚Ä¢ Maltitol
‚Ä¢ Xylitol

Balance by PAC not %:
Target 240-260 PAC total

Add:
‚Ä¢ Fiber (structure)
‚Ä¢ Maltodextrin (body)
‚Ä¢ High-intensity sweeteners (taste)

Challenge: Laxative effect at high doses

SUGAR-FREE:

Not truly zero sugar (milk has lactose)
"No added sugar" more accurate

Use:
‚Ä¢ Polyalcohols for PAC
‚Ä¢ Sweeteners for taste
‚Ä¢ Fiber for structure
‚Ä¢ Careful labeling

LACTOSE-FREE:

Use:
‚Ä¢ Lactose-free milk
‚Ä¢ PAC adjustment needed
‚Ä¢ Lactose-free cream
‚Ä¢ Or plant-based alternatives

Note: Lactose PAC low (1.0)
May need more dextrose

NUTRACEUTICAL:

Add beneficial compounds:
‚Ä¢ Polyphenols (berries, cocoa)
‚Ä¢ Beta-carotene (carrots)
‚Ä¢ Omega-3
‚Ä¢ Probiotics (challenging)
‚Ä¢ Vitamins

Advantage:
Cold preserves nutrients
No heat damage

LOW-CALORIE:

Strategies:
‚Ä¢ Use polyalcohols (2.4 kcal/g vs 4)
‚Ä¢ Increase fiber
‚Ä¢ Reduce fat (minimum 5%)
‚Ä¢ Use intense sweeteners
‚Ä¢ More air (higher overrun)

Calculation:
‚Ä¢ Carbs: 4 kcal/g
‚Ä¢ Protein: 4 kcal/g
‚Ä¢ Fat: 9 kcal/g
‚Ä¢ Fiber: 2 kcal/g
‚Ä¢ Polyalcohols: 2.4 kcal/g

GLUTEN-FREE:

Naturally gluten-free:
Most gelato (no wheat)

Watch for:
‚Ä¢ Cookie pieces
‚Ä¢ Cake inclusions
‚Ä¢ Some flavorings
‚Ä¢ Cross-contamination

Easy to achieve
Good marketing claim`
};

// ========================================
// INGREDIENTS DATABASE
// ========================================
const ING=[
{n:'Sucrose',pod:100,pac:100,s:100,w:0,f:0,p:0},
{n:'Dextrose',pod:70,pac:190,s:100,w:0,f:0,p:0},
{n:'Fructose',pod:130,pac:190,s:100,w:0,f:0,p:0},
{n:'Glucose 42DE',pod:45,pac:140,s:80,w:20,f:0,p:0},
{n:'Glucose 60DE',pod:65,pac:180,s:80,w:20,f:0,p:0},
{n:'Invert Sugar',pod:115,pac:130,s:75,w:25,f:0,p:0},
{n:'Trehalose',pod:45,pac:100,s:100,w:0,f:0,p:0},
{n:'Maltodextrin',pod:30,pac:30,s:100,w:0,f:0,p:0},
{n:'Whole Milk 3.5%',pod:0,pac:0,s:12.5,w:87.5,f:3.5,p:3.3},
{n:'Skim Milk',pod:0,pac:0,s:10,w:90,f:0.1,p:3.4},
{n:'Cream 30%',pod:0,pac:0,s:35,w:65,f:30,p:2.5},
{n:'Cream 35%',pod:0,pac:0,s:40,w:60,f:35,p:2.2},
{n:'Milk Powder Skim',pod:0,pac:0,s:96,w:4,f:0,p:36},
{n:'Milk Powder Whole',pod:0,pac:0,s:97,w:3,f:26,p:26},
{n:'Egg Yolk',pod:0,pac:0,s:52,w:48,f:32,p:16},
{n:'Stabilizer',pod:0,pac:0,s:100,w:0,f:0,p:0},
{n:'Emulsifier',pod:0,pac:0,s:100,w:0,f:0,p:0},
{n:'Cocoa 22%',pod:0,pac:0,s:97,w:3,f:22,p:20},
{n:'Hazelnut Paste',pod:0,pac:0,s:98,w:2,f:60,p:15},
{n:'Pistachio Paste',pod:0,pac:0,s:96,w:4,f:55,p:20},
{n:'Coconut Oil',pod:0,pac:0,s:100,w:0,f:100,p:0},
{n:'Inulin',pod:0,pac:0,s:100,w:0,f:0,p:0},
{n:'Erythritol',pod:70,pac:280,s:100,w:0,f:0,p:0},
{n:'Sorbitol',pod:60,pac:190,s:100,w:0,f:0,p:0},
{n:'Strawberry Puree',pod:0,pac:0,s:10,w:90,f:0,p:0.8},
{n:'Mango Puree',pod:0,pac:0,s:15,w:85,f:0,p:0.5},
{n:'Lemon Juice',pod:0,pac:0,s:8,w:92,f:0,p:0.4}
];

const REC=[
{n:'Vanilla Cream',c:'Classic',b:'Milk 700g, Cream 35% 100g, Sucrose 150g, Dextrose 30g, Milk Powder 20g, Stabilizer 5g, Emulsifier 3g, Vanilla 2g',note:'Base cream, PAC ~240'},
{n:'Chocolate',c:'Classic',b:'Milk 600g, Cream 80g, Sucrose 140g, Dextrose 35g, Cocoa 22% 80g, Milk Powder 30g, Stabilizer 5g, Emulsifier 3g',note:'Rich, adjust cocoa for intensity'},
{n:'Hazelnut',c:'Nut',b:'Milk 650g, Cream 80g, Sucrose 130g, Dextrose 35g, Hazelnut Paste 120g, Milk Powder 20g, Stabilizer 5g, Emulsifier 3g',note:'Quality paste = quality gelato'},
{n:'Pistachio',c:'Nut',b:'Milk 620g, Cream 70g, Sucrose 130g, Dextrose 40g, Pistachio Paste 120g, Salt 3g, Milk Powder 20g, Stabilizer 5g, Emulsifier 3g',note:'Real pistachio essential'},
{n:'Strawberry Sorbet',c:'Fruit',b:'Strawberry 400g, Sucrose 180g, Dextrose 30g, Glucose 42DE 20g, Water 360g, Stabilizer 7g, Lemon 10g',note:'26% total sugar'},
{n:'Lemon Sorbet',c:'Fruit',b:'Lemon Juice 180g, Sucrose 220g, Dextrose 40g, Water 540g, Inulin 15g, Stabilizer 5g',note:'Freeze immediately'},
{n:'Vegan Vanilla',c:'Vegan',b:'Oat Milk 700g, Coconut Oil 80g, Sucrose 150g, Dextrose 30g, Potato Protein 20g, Stabilizer 6g, Vanilla 2g',note:'Refined coconut oil best'},
{n:'Amaretto Cream',c:'Alcoholic',b:'Milk 680g, Cream 100g, Sucrose 130g, Dextrose 25g, Amaretto 28% 70g, Milk Powder 20g, Stabilizer 5g, Emulsifier 3g',note:'~2% alcohol'},
{n:'Tiramisu',c:'Specialty',b:'Milk 600g, Cream 100g, Mascarpone 80g, Sucrose 130g, Dextrose 30g, Coffee 30g, Milk Powder 15g, Stabilizer 5g, Emulsifier 3g',note:'Coffee concentrate'},
{n:'Mango Sorbet',c:'Fruit',b:'Mango Puree 450g, Sucrose 190g, Dextrose 35g, Glucose 42DE 25g, Water 290g, Stabilizer 7g, Lime 5g',note:'Use ripe mango'}
];

// ========================================
// APP STATE & LOGIC
// ========================================
let pg='home',ing=[{n:'',a:''}],res=null,q='',ans='',kb='',sr=null;

function calc(){
let t=0,pac=0,pod=0,s=0,w=0,f=0,p=0;
ing.forEach(i=>{
const d=ING.find(x=>x.n===i.n);
if(d&&i.a){
const a=+i.a;
t+=a;
pac+=(d.pac*a)/100;
pod+=(d.pod*a)/100;
s+=(d.s*a)/100;
w+=(d.w*a)/100;
f+=(d.f*a)/100;
p+=(d.p*a)/100;
}
});
if(t===0){alert('Add ingredients');return;}
res={w:t.toFixed(0),pac:pac.toFixed(0),pod:pod.toFixed(1),s:s.toFixed(1),wt:w.toFixed(1),f:f.toFixed(1),p:p.toFixed(1)};
rend();
}

function ai(){
const x=q.toLowerCase();
if(x.includes('pac')||x.includes('hard')||x.includes('soft'))ans=KB.sug_adv;
else if(x.includes('pod')||x.includes('sweet'))ans=KB.sug_adv;
else if(x.includes('stabilizer')||x.includes('icy')||x.includes('crystal'))ans=KB.past+'\n\n'+KB.matur;
else if(x.includes('emulsifier'))ans=KB.prot;
else if(x.includes('problem')||x.includes('fix')||x.includes('trouble'))ans=KB.trouble;
else if(x.includes('production')||x.includes('process')||x.includes('cycle'))ans=KB.prod;
else if(x.includes('pasteuriz'))ans=KB.past;
else if(x.includes('matur')||x.includes('aging'))ans=KB.matur;
else if(x.includes('batch')||x.includes('freez')||x.includes('churn'))ans=KB.batch;
else if(x.includes('blast')||x.includes('chill')||x.includes('storage'))ans=KB.blast;
else if(x.includes('cream')||x.includes('crema'))ans=KB.cream;
else if(x.includes('sorbet')||x.includes('fruit'))ans=KB.sorb;
else if(x.includes('vegan')||x.includes('special')||x.includes('alcohol')||x.includes('low'))ans=KB.special;
else if(x.includes('protein'))ans=KB.prot;
else if(x.includes('fat')||x.includes('oil')||x.includes('coconut'))ans=KB.fats;
else if(x.includes('fiber')||x.includes('inulin'))ans=KB.fib;
else if(x.includes('polyalcohol')||x.includes('erythritol')||x.includes('sorbitol'))ans=KB.poly;
else if(x.includes('alcohol')||x.includes('liquor')||x.includes('wine'))ans=KB.alc;
else if(x.includes('equipment')||x.includes('machine'))ans=KB.equip;
else ans=KB.fund+'\n\nAsk about: PAC, POD, stabilizers, problems, recipes, production, equipment';
rend();
}

function rend(){
document.getElementById('root').innerHTML=
pg==='home'?home():
pg==='calc'?calculator():
pg==='ai'?expert():
pg==='rec'?recipes():
pg==='kb'?knowledge():'';
}

function home(){
return`<div class="min-h-screen">
<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 py-4">
<h1 class="text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
Professional Gelato Expert Platform</h1>
<p class="text-sm text-gray-600 mt-1">Complete professional knowledge & tools</p>
</div></nav>
<div class="max-w-7xl mx-auto px-4 py-12">
<div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
${[
['üìä','Calculator','POD/PAC/Solids Analysis','calc','from-blue-500 to-cyan-500'],
['üéì','AI Expert','Professional Consultation','ai','from-purple-500 to-pink-500'],
['üìö','Recipes','10+ Professional Formulas','rec','from-green-500 to-emerald-500'],
['üìñ','Knowledge','Complete Reference','kb','from-orange-500 to-red-500']
].map(([i,t,d,p,g])=>`
<div onclick="pg='${p}';rend();" class="section-card cursor-pointer bg-white rounded-2xl shadow-lg p-8 hover:shadow-2xl">
<div class="text-6xl mb-4">${i}</div>
<h2 class="text-2xl font-bold mb-2 bg-gradient-to-r ${g} bg-clip-text text-transparent">${t}</h2>
<p class="text-gray-600">${d}</p>
<div class="mt-4 text-purple-600 font-semibold">Explore ‚Üí</div>
</div>`).join('')}
</div>
<div class="mt-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl p-8 text-white">
<h2 class="text-3xl font-bold mb-4">Professional Gelato Making Platform</h2>
<p class="text-lg mb-4">Complete knowledge base from professional gelato science</p>
<div class="grid md:grid-cols-3 gap-4 text-sm">
<div>‚úì Volume 1 & 2 Knowledge</div>
<div>‚úì Advanced Calculations</div>
<div>‚úì Problem Solving</div>
<div>‚úì Recipe Formulation</div>
<div>‚úì Equipment Guidance</div>
<div>‚úì Special Gelatos</div>
</div>
</div>
</div></div>`;
}

function calculator(){
return`<div class="min-h-screen">
<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
<button onclick="pg='home';rend();" class="text-purple-600 font-semibold">‚Üê Home</button>
<h2 class="text-xl font-bold">Professional Calculator</h2>
<button onclick="pg='ai';rend();" class="text-purple-600 font-semibold">AI Expert ‚Üí</button>
</div></nav>
<div class="max-w-6xl mx-auto px-4 py-8">
<div class="bg-white rounded-xl shadow-lg p-6 mb-6">
<h3 class="text-2xl font-bold mb-4">Recipe Calculator</h3>
<div class="space-y-3 mb-6">
${ing.map((x,i)=>`<div class="flex gap-3">
<select onchange="ing[${i}].n=this.value;rend();" class="flex-1 px-4 py-2 border rounded-lg bg-white">
<option value="">Select ingredient...</option>
${ING.map(t=>`<option value="${t.n}"${x.n===t.n?' selected':''}>${t.n}</option>`).join('')}
</select>
<input type="number" value="${x.a}" onchange="ing[${i}].a=this.value" placeholder="grams" class="w-32 px-4 py-2 border rounded-lg">
${i>0?`<button onclick="ing.splice(${i},1);rend();" class="px-3 text-red-500 hover:bg-red-50 rounded-lg">√ó</button>`:''}
</div>`).join('')}
</div>
<div class="flex gap-4">
<button onclick="ing.push({n:'',a:''});rend();" class="px-6 py-2 bg-gray-200 rounded-lg hover:bg-gray-300">+ Add Ingredient</button>
<button onclick="calc();" class="px-8 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg font-semibold hover:shadow-lg">Calculate</button>
</div>
</div>
${res?`<div class="bg-white rounded-xl shadow-lg p-6 fade-in">
<h3 class="text-2xl font-bold mb-6">Technical Analysis</h3>
<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
${[
['Weight',res.w+'g','blue',''],
['PAC',res.pac,'purple','200-280 cream'],
['POD',res.pod+'%','pink','16-22%'],
['Solids',res.s+'%','green','36-42%'],
['Water',res.wt+'%','cyan',''],
['Fat',res.f+'%','yellow','6-10%'],
['Protein',res.p+'%','indigo','4-5%'],
['Status','‚úì','emerald','Balanced']
].map(([l,v,c,t])=>`
<div class="bg-${c}-50 rounded-xl p-4 border-2 border-${c}-200">
<div class="text-sm text-gray-600 font-semibold">${l}</div>
<div class="text-3xl font-bold text-${c}-700 my-2">${v}</div>
${t?`<div class="text-xs text-gray-500">${t}</div>`:''}</div>`).join('')}
</div></div>`:''}</div></div>`;
}

function expert(){
return`<div class="min-h-screen">
<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
<button onclick="pg='calc';rend();" class="text-purple-600 font-semibold">‚Üê Calculator</button>
<h2 class="text-xl font-bold">AI Gelato Expert</h2>
<button onclick="pg='rec';rend();" class="text-purple-600 font-semibold">Recipes ‚Üí</button>
</div></nav>
<div class="max-w-5xl mx-auto px-4 py-8">
<div class="bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl p-8 text-white mb-6">
<h2 class="text-3xl font-bold mb-2">üéì Professional Gelato Expert</h2>
<p class="text-lg">Complete professional knowledge - Ask anything!</p>
</div>
<div class="bg-white rounded-xl shadow-lg p-6 mb-6">
<label class="block text-sm font-semibold text-gray-700 mb-2">Your Question:</label>
<textarea id="q" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg h-32 mb-4 focus:border-purple-500 focus:outline-none"
placeholder="Examples:
‚Ä¢ Why is my gelato icy?
‚Ä¢ How to calculate PAC?
‚Ä¢ What stabilizers should I use?
‚Ä¢ Explain maturation process
‚Ä¢ How to fix hard gelato?">${q}</textarea>
<button onclick="q=document.getElementById('q').value;ai();" 
class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-bold text-lg hover:shadow-lg">
ü§ñ Ask Expert</button>
</div>
${ans?`<div class="bg-white rounded-xl shadow-lg p-8 border-2 border-purple-200 fade-in">
<h3 class="text-xl font-bold mb-4 text-purple-900">üìñ Expert Response:</h3>
<div class="whitespace-pre-line text-gray-800 leading-relaxed">${ans}</div>
</div>`:''}</div></div>`;
}

function recipes(){
if(sr)return`<div class="min-h-screen">
<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
<button onclick="sr=null;rend();" class="text-purple-600 font-semibold">‚Üê Back to Recipes</button>
<h2 class="text-xl font-bold">${sr.n}</h2>
<div></div>
</div></nav>
<div class="max-w-4xl mx-auto px-4 py-8">
<div class="bg-white rounded-xl shadow-lg p-8">
<h1 class="text-4xl font-bold mb-4">${sr.n}</h1>
<span class="inline-block bg-purple-100 text-purple-700 px-4 py-2 rounded-full font-semibold mb-6">${sr.c}</span>
<div class="bg-blue-50 rounded-lg p-6 mb-4 border-2 border-blue-200">
<h3 class="font-bold text-lg mb-3 text-blue-900">Formula (1000g total):</h3>
<p class="text-gray-800 leading-relaxed">${sr.b}</p>
</div>
<div class="bg-green-50 rounded-lg p-6 border-2 border-green-200">
<h3 class="font-bold text-lg mb-3 text-green-900">Professional Notes:</h3>
<p class="text-gray-800">${sr.note}</p>
</div>
</div></div></div>`;

return`<div class="min-h-screen">
<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
<button onclick="pg='ai';rend();" class="text-purple-600 font-semibold">‚Üê AI Expert</button>
<h2 class="text-xl font-bold">Professional Recipes (${REC.length})</h2>
<button onclick="pg='kb';rend();" class="text-purple-600 font-semibold">Knowledge ‚Üí</button>
</div></nav>
<div class="max-w-7xl mx-auto px-4 py-8">
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
${REC.map(r=>`<div onclick='sr=${JSON.stringify(r).replace(/'/g,"\\'")}; rend();' 
class="section-card cursor-pointer bg-white rounded-xl shadow-lg p-6 hover:shadow-2xl">
<h3 class="text-2xl font-bold mb-2">${r.n}</h3>
<span class="inline-block bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm mb-3">${r.c}</span>
<p class="text-sm text-gray-600 mb-4">${r.b.substring(0,100)}...</p>
<button class="w-full py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg font-semibold">
View Recipe ‚Üí</button>
</div>`).join('')}
</div></div></div>`;
}

function knowledge(){
if(kb){
const title=kb.replace(/_/g,' ').split(' ').map(w=>w.charAt(0).toUpperCase()+w.slice(1)).join(' ');
return`<div class="min-h-screen">
<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 py-4">
<button onclick="kb='';rend();" class="text-purple-600 font-semibold">‚Üê Back to Knowledge Base</button>
</div></nav>
<div class="max-w-5xl mx-auto px-4 py-8">
<div class="bg-white rounded-xl shadow-lg p-8">
<h1 class="text-4xl font-bold mb-6 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
${title}</h1>
<div class="whitespace-pre-line text-gray-800 leading-relaxed text-lg">${KB[kb]}</div>
</div></div></div>`;
}

return`<div class="min-h-screen">
<nav class="bg-white shadow"><div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
<button onclick="pg='rec';rend();" class="text-purple-600 font-semibold">‚Üê Recipes</button>
<h2 class="text-xl font-bold">Complete Knowledge Base</h2>
<button onclick="pg='home';rend();" class="text-purple-600 font-semibold">Home ‚Üí</button>
</div></nav>
<div class="max-w-7xl mx-auto px-4 py-8">
<div class="bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl p-8 text-white mb-8">
<h1 class="text-4xl font-bold mb-3">üìö Professional Knowledge Base</h1>
<p class="text-xl">Complete reference from professional gelato science</p>
</div>
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
${Object.keys(KB).map(k=>{
const t=k.replace(/_/g,' ').split(' ').map(w=>w.charAt(0).toUpperCase()+w.slice(1)).join(' ');
return`<div onclick="kb='${k}';rend();" 
class="section-card cursor-pointer bg-white rounded-xl shadow-lg p-6 hover:shadow-2xl">
<h3 class="text-xl font-bold mb-3 text-purple-900">${t}</h3>
<p class="text-sm text-gray-600 line-clamp-3 mb-4">${KB[k].substring(0,120)}...</p>
<div class="text-purple-600 font-semibold">Read More ‚Üí</div>
</div>`;
}).join('')}
</div></div></div>`;
}

rend();
</script>
</body>
</html>
